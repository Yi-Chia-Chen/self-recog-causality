const PHYSICAL_TRIGGER_DIST = 10;
const SOCIAL_TRIGGER_DIST = 100;
const NO_TRIGGER_DIST = 2;
const DISK_SPEED = 1;
const OTHER_TRAJECTORY = [[0.579, { x: 98, y: 351.5 }], [0.585, { x: 98, y: 351 }], [0.602, { x: 98, y: 349 }], [0.611, { x: 101, y: 346 }], [0.618, { x: 102, y: 344 }], [0.624, { x: 104, y: 343 }], [0.648, { x: 105, y: 341 }], [0.656, { x: 109, y: 336 }], [0.663, { x: 111, y: 335 }], [0.673, { x: 112, y: 333 }], [0.684, { x: 113, y: 333 }], [0.689, { x: 115, y: 330 }], [0.733, { x: 117, y: 328 }], [0.735, { x: 129, y: 313 }], [0.743, { x: 131, y: 310 }], [0.751, { x: 133, y: 308 }], [0.758, { x: 135, y: 305 }], [0.767, { x: 136, y: 303 }], [0.777, { x: 139, y: 301 }], [0.782, { x: 140, y: 299 }], [0.791, { x: 141, y: 297 }], [0.799, { x: 144, y: 294 }], [0.808, { x: 144, y: 293 }], [0.814, { x: 147, y: 290 }], [0.824, { x: 148, y: 288 }], [0.83, { x: 149, y: 286 }], [0.838, { x: 152, y: 283 }], [0.847, { x: 153, y: 281 }], [0.855, { x: 155, y: 279 }], [0.862, { x: 155, y: 278 }], [0.87, { x: 157, y: 276 }], [0.879, { x: 158, y: 274 }], [0.887, { x: 161, y: 270 }], [0.895, { x: 162, y: 268 }], [0.902, { x: 163, y: 266 }], [0.911, { x: 164, y: 264 }], [0.918, { x: 166, y: 262 }], [0.927, { x: 167, y: 260 }], [0.936, { x: 168, y: 259 }], [0.953, { x: 169, y: 257 }], [0.969, { x: 170, y: 255 }], [0.982, { x: 172, y: 253 }], [0.983, { x: 172, y: 252 }], [0.992, { x: 173, y: 251 }], [0.999, { x: 174, y: 250 }], [1.008, { x: 174, y: 249 }], [1.014, { x: 175, y: 248 }], [1.022, { x: 175, y: 248 }], [1.03, { x: 175, y: 247 }], [1.039, { x: 176, y: 246 }], [1.046, { x: 176, y: 246 }], [1.054, { x: 176, y: 246 }], [1.071, { x: 177, y: 245 }], [1.258, { x: 177, y: 245 }], [1.264, { x: 177, y: 245 }], [1.279, { x: 177, y: 246 }], [1.286, { x: 177, y: 246 }], [1.295, { x: 177, y: 246 }], [1.303, { x: 177, y: 246 }], [1.311, { x: 177, y: 247 }], [1.318, { x: 177, y: 247 }], [1.327, { x: 177, y: 247 }], [1.334, { x: 177, y: 247 }], [1.342, { x: 177, y: 248 }], [1.35, { x: 177, y: 248 }], [1.362, { x: 177, y: 249 }], [1.366, { x: 177, y: 249 }], [1.374, { x: 178, y: 250 }], [1.382, { x: 178, y: 252 }], [1.392, { x: 178, y: 253 }], [1.398, { x: 178, y: 254 }], [1.407, { x: 179, y: 255 }], [1.414, { x: 179, y: 257 }], [1.422, { x: 180, y: 259 }], [1.43, { x: 180, y: 260 }], [1.438, { x: 181, y: 262 }], [1.448, { x: 182, y: 264 }], [1.466, { x: 183, y: 266 }], [1.47, { x: 184, y: 270 }], [1.478, { x: 185, y: 271 }], [1.486, { x: 186, y: 273 }], [1.494, { x: 187, y: 275 }], [1.502, { x: 188, y: 276 }], [1.511, { x: 189, y: 278 }], [1.518, { x: 189, y: 279 }], [1.543, { x: 190, y: 280 }], [1.544, { x: 192, y: 282 }], [1.55, { x: 193, y: 283 }], [1.559, { x: 195, y: 285 }], [1.566, { x: 196, y: 286 }], [1.574, { x: 197, y: 287 }], [1.582, { x: 198, y: 289 }], [1.591, { x: 200, y: 291 }], [1.598, { x: 202, y: 293 }], [1.607, { x: 203, y: 295 }], [1.614, { x: 205, y: 297 }], [1.623, { x: 206, y: 300 }], [1.63, { x: 209, y: 304 }], [1.638, { x: 209, y: 305 }], [1.646, { x: 211, y: 309 }], [1.655, { x: 212, y: 311 }], [1.662, { x: 214, y: 314 }], [1.67, { x: 216, y: 317 }], [1.679, { x: 217, y: 319 }], [1.686, { x: 219, y: 323 }], [1.695, { x: 220, y: 325 }], [1.702, { x: 222, y: 327 }], [1.71, { x: 223, y: 330 }], [1.718, { x: 224, y: 332 }], [1.727, { x: 226, y: 335 }], [1.734, { x: 227, y: 337 }], [1.742, { x: 228, y: 338 }], [1.75, { x: 229, y: 340 }], [1.758, { x: 230, y: 341 }], [1.766, { x: 230, y: 342 }], [1.774, { x: 231, y: 343 }], [1.782, { x: 231, y: 344 }], [1.791, { x: 232, y: 345 }], [1.798, { x: 233, y: 346 }], [1.807, { x: 233, y: 347 }], [1.814, { x: 234, y: 348 }], [1.822, { x: 234, y: 348 }], [1.83, { x: 235, y: 350 }], [1.838, { x: 235, y: 350 }], [1.846, { x: 236, y: 351 }], [1.854, { x: 236, y: 352 }], [1.862, { x: 236, y: 352 }], [1.87, { x: 237, y: 353 }], [1.878, { x: 237, y: 353 }], [1.886, { x: 237, y: 353 }], [1.893, { x: 237, y: 353 }], [1.902, { x: 237, y: 354 }], [1.91, { x: 237, y: 354 }], [1.918, { x: 237, y: 354 }], [1.926, { x: 237, y: 354 }], [1.934, { x: 237, y: 355 }], [1.942, { x: 237, y: 355 }], [1.958, { x: 237, y: 355 }], [2.128, { x: 238, y: 355 }], [2.135, { x: 238, y: 355 }], [2.143, { x: 238, y: 355 }], [2.15, { x: 238, y: 355 }], [2.159, { x: 239, y: 354 }], [2.166, { x: 240, y: 354 }], [2.176, { x: 240, y: 353 }], [2.182, { x: 242, y: 352 }], [2.192, { x: 243, y: 349 }], [2.198, { x: 244, y: 347 }], [2.206, { x: 247, y: 344 }], [2.214, { x: 248, y: 341 }], [2.221, { x: 250, y: 337 }], [2.23, { x: 253, y: 333 }], [2.238, { x: 255, y: 329 }], [2.246, { x: 256, y: 327 }], [2.253, { x: 258, y: 324 }], [2.262, { x: 259, y: 321 }], [2.27, { x: 261, y: 318 }], [2.277, { x: 262, y: 315 }], [2.285, { x: 263, y: 313 }], [2.294, { x: 265, y: 311 }], [2.301, { x: 267, y: 306 }], [2.312, { x: 268, y: 304 }], [2.318, { x: 270, y: 302 }], [2.34, { x: 271, y: 300 }], [2.349, { x: 274, y: 294 }], [2.35, { x: 276, y: 291 }], [2.357, { x: 277, y: 288 }], [2.365, { x: 279, y: 286 }], [2.376, { x: 280, y: 283 }], [2.381, { x: 281, y: 280 }], [2.391, { x: 282, y: 278 }], [2.397, { x: 284, y: 275 }], [2.405, { x: 286, y: 271 }], [2.413, { x: 286, y: 269 }], [2.422, { x: 287, y: 266 }], [2.429, { x: 289, y: 264 }], [2.437, { x: 289, y: 262 }], [2.446, { x: 290, y: 259 }], [2.454, { x: 291, y: 258 }], [2.461, { x: 291, y: 257 }], [2.469, { x: 292, y: 256 }], [2.478, { x: 292, y: 255 }], [2.487, { x: 292, y: 255 }], [2.493, { x: 292, y: 255 }], [2.525, { x: 293, y: 255 }], [2.534, { x: 293, y: 254 }], [2.541, { x: 293, y: 254 }], [2.55, { x: 293, y: 254 }], [2.557, { x: 294, y: 254 }], [2.566, { x: 294, y: 253 }], [2.573, { x: 294, y: 253 }], [2.581, { x: 294, y: 253 }], [2.589, { x: 295, y: 252 }], [2.597, { x: 295, y: 252 }], [2.605, { x: 295, y: 251 }], [2.613, { x: 296, y: 251 }], [2.622, { x: 296, y: 250 }], [2.629, { x: 296, y: 250 }], [2.638, { x: 296, y: 250 }], [2.67, { x: 296, y: 250 }], [2.677, { x: 296, y: 250 }], [2.897, { x: 296, y: 250 }], [2.903, { x: 296, y: 250 }], [2.909, { x: 297, y: 250 }], [2.918, { x: 297, y: 250 }], [2.925, { x: 297, y: 250 }], [2.935, { x: 297, y: 251 }], [2.943, { x: 297, y: 251 }], [2.949, { x: 298, y: 251 }], [2.957, { x: 299, y: 252 }], [2.967, { x: 300, y: 254 }], [2.973, { x: 301, y: 256 }], [2.981, { x: 304, y: 260 }], [2.989, { x: 306, y: 264 }], [2.997, { x: 309, y: 269 }], [3.006, { x: 313, y: 274 }], [3.013, { x: 316, y: 279 }], [3.021, { x: 320, y: 284 }], [3.029, { x: 323, y: 291 }], [3.037, { x: 326, y: 295 }], [3.045, { x: 328, y: 301 }], [3.053, { x: 329, y: 302 }], [3.061, { x: 332, y: 307 }], [3.069, { x: 333, y: 310 }], [3.077, { x: 335, y: 313 }], [3.088, { x: 337, y: 316 }], [3.094, { x: 338, y: 318 }], [3.102, { x: 339, y: 319 }], [3.109, { x: 340, y: 321 }], [3.128, { x: 341, y: 322 }], [3.133, { x: 342, y: 322 }], [3.14, { x: 342, y: 323 }], [3.181, { x: 343, y: 324 }], [3.185, { x: 345, y: 326 }], [3.191, { x: 346, y: 326 }], [3.201, { x: 346, y: 327 }], [3.205, { x: 347, y: 327 }], [3.213, { x: 347, y: 328 }], [3.221, { x: 349, y: 328 }], [3.229, { x: 349, y: 329 }], [3.238, { x: 349, y: 329 }], [3.245, { x: 350, y: 330 }], [3.253, { x: 350, y: 330 }], [3.261, { x: 351, y: 330 }], [3.269, { x: 351, y: 331 }], [3.276, { x: 352, y: 331 }], [3.285, { x: 352, y: 331 }], [3.293, { x: 352, y: 331 }], [3.301, { x: 352, y: 332 }], [3.318, { x: 353, y: 333 }], [3.325, { x: 355, y: 336 }], [3.337, { x: 356, y: 337 }], [3.341, { x: 357, y: 339 }], [3.352, { x: 358, y: 341 }], [3.357, { x: 359, y: 342 }], [3.365, { x: 360, y: 344 }], [3.372, { x: 360, y: 345 }], [3.38, { x: 361, y: 346 }], [3.389, { x: 361, y: 346 }], [3.397, { x: 361, y: 347 }], [3.405, { x: 362, y: 347 }], [3.413, { x: 362, y: 347 }], [3.697, { x: 362, y: 347 }], [3.702, { x: 362, y: 347 }], [3.709, { x: 362, y: 346 }], [3.718, { x: 363, y: 345 }], [3.726, { x: 365, y: 342 }], [3.735, { x: 368, y: 340 }], [3.74, { x: 371, y: 336 }], [3.749, { x: 373, y: 334 }], [3.756, { x: 376, y: 331 }], [3.765, { x: 379, y: 329 }], [3.773, { x: 382, y: 326 }], [3.781, { x: 384, y: 324 }], [3.788, { x: 386, y: 323 }], [3.796, { x: 388, y: 321 }], [3.805, { x: 389, y: 319 }], [3.812, { x: 391, y: 318 }], [3.822, { x: 392, y: 317 }], [3.83, { x: 394, y: 315 }], [3.838, { x: 395, y: 313 }], [3.845, { x: 396, y: 311 }], [3.854, { x: 398, y: 309 }], [3.861, { x: 399, y: 306 }], [3.872, { x: 401, y: 305 }], [3.878, { x: 402, y: 302 }], [3.885, { x: 403, y: 300 }], [3.893, { x: 404, y: 299 }], [3.9, { x: 404, y: 297 }], [3.908, { x: 405, y: 295 }], [3.92, { x: 406, y: 293 }], [3.925, { x: 407, y: 292 }], [3.932, { x: 407, y: 291 }], [3.94, { x: 408, y: 289 }], [3.95, { x: 409, y: 288 }], [3.957, { x: 410, y: 287 }], [3.964, { x: 410, y: 286 }], [3.972, { x: 410, y: 285 }], [3.98, { x: 411, y: 285 }], [3.989, { x: 411, y: 284 }], [3.996, { x: 412, y: 284 }], [4.004, { x: 412, y: 283 }], [4.012, { x: 413, y: 283 }], [4.021, { x: 414, y: 282 }], [4.028, { x: 414, y: 281 }], [4.036, { x: 415, y: 281 }], [4.044, { x: 416, y: 280 }], [4.052, { x: 417, y: 279 }], [4.06, { x: 420, y: 276 }], [4.068, { x: 422, y: 273 }], [4.076, { x: 424, y: 270 }], [4.084, { x: 426, y: 268 }], [4.092, { x: 428, y: 264 }], [4.101, { x: 429, y: 262 }], [4.108, { x: 431, y: 260 }], [4.116, { x: 432, y: 258 }], [4.128, { x: 433, y: 257 }], [4.136, { x: 433, y: 256 }], [4.14, { x: 434, y: 256 }], [4.148, { x: 434, y: 255 }], [4.164, { x: 434, y: 255 }], [4.392, { x: 434, y: 255 }], [4.404, { x: 434, y: 255 }], [4.412, { x: 435, y: 255 }], [4.42, { x: 435, y: 255 }], [4.428, { x: 435, y: 257 }], [4.436, { x: 437, y: 258 }], [4.444, { x: 438, y: 261 }], [4.453, { x: 439, y: 263 }], [4.46, { x: 441, y: 265 }], [4.47, { x: 445, y: 270 }], [4.476, { x: 448, y: 274 }], [4.486, { x: 452, y: 278 }], [4.492, { x: 456, y: 283 }], [4.502, { x: 460, y: 287 }], [4.508, { x: 465, y: 293 }], [4.516, { x: 469, y: 298 }], [4.55, { x: 473, y: 304 }], [4.556, { x: 486, y: 325 }], [4.564, { x: 488, y: 327 }], [4.574, { x: 490, y: 330 }], [4.610, { x: 495, y: 334 } ], [4.620, { x: 500, y: 340 }]];

const TARGET_LIST_DICT = {
    0: {feedback: 'other', consequence: 'physical'},
    1: {feedback: 'other', consequence: 'social'},
    2: {feedback: 'other', consequence: 'no'},
    3: {feedback: 'self', consequence: 'physical'},
    4: {feedback: 'self', consequence: 'social'},
    5: {feedback: 'self', consequence: 'no'},
};
var canvas, ctx;
var trialIndex = 1;
var tracingTask;

$(document).ready(function() {
    SETUP_TRACING_CANVAS();
    SHOW_INTRO();
});

function START_TRIAL() {
    SETUP_TRACING_INTERFACE();
    var trialInfo = TARGET_LIST_DICT[trialIndex];
    if (trialInfo['feedback'] == 'other'){
        tracingTask = new otherTrajectoryObject(trialInfo['consequence']);
        $('#start').click(tracingTask.start);

    } else if (trialInfo['feedback'] == 'self') {
        tracingTask = new selfTrajectoryObject(trialInfo['consequence']);
        $('#start').click(tracingTask.start);
    }
    SHOW_TRACING_TASK();
    trialIndex++;
}

